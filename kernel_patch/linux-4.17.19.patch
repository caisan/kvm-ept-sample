diff -r linux-4.17.19/arch/x86/kvm/Kconfig ../linux-4.17.19/arch/x86/kvm/Kconfig
73a74,79
> config KVM_EPT_SAMPLE
> 	bool "KVM EPT memory access sample support"
> 	depends on KVM_INTEL && X86_64
> 	---help---
> 	  Provides support for memory access sample of a KVM instance based on VT-x.
> 
diff -r linux-4.17.19/arch/x86/kvm/vmx.c ../linux-4.17.19/arch/x86/kvm/vmx.c
7230a7231,7235
> #ifdef CONFIG_KVM_EPT_SAMPLE
>     struct kvm* kvm = vcpu->kvm;
>     typeof(kvm->on_ept_sample) on_ept_sample = kvm->on_ept_sample;
>     gpa = vmcs_read64(GUEST_PHYSICAL_ADDRESS);
> #endif
7233a7239,7242
> #ifdef CONFIG_KVM_EPT_SAMPLE
>     if(on_ept_sample && on_ept_sample(kvm, (unsigned long)gpa, exit_qualification))
>         return 1;
> #endif
7244a7254
> #ifndef CONFIG_KVM_EPT_SAMPLE
7245a7256
> #endif
diff -r linux-4.17.19/include/linux/kvm_host.h ../linux-4.17.19/include/linux/kvm_host.h
448a449,452
> #ifdef CONFIG_KVM_EPT_SAMPLE
>     int (*on_ept_sample)(struct kvm* kvm, unsigned long gpa, unsigned long code);
>     void* ept_sample_privdata;
> #endif
